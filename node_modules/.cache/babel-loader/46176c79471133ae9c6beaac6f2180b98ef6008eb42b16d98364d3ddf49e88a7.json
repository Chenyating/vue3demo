{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Fuse from 'fuse.js';\nimport path from 'path';\n// import i18n from '@/lang'\n\nexport default {\n  name: 'HeaderSearch',\n  props: {\n    allMenu: {\n      type: Array,\n      default: () => []\n    }\n  },\n  data() {\n    return {\n      search: '',\n      options: [],\n      searchPool: [],\n      show: false,\n      fuse: undefined\n    };\n  },\n  // computed: {\n  //   lang () {\n  //     return this.$store.getters.language\n  //   }\n  // },\n  watch: {\n    // lang () {\n    //   this.searchPool = this.generateRoutes(this.allMenu)\n    // },\n    // routes () {\n    //   this.searchPool = this.generateRoutes(this.allMenu)\n    // },\n    searchPool(list) {\n      this.initFuse(list);\n    },\n    show(value) {\n      if (value) {\n        document.body.addEventListener('click', this.close);\n      } else {\n        document.body.removeEventListener('click', this.close);\n      }\n    }\n  },\n  mounted() {\n    this.searchPool = this.generateRoutes(this.allMenu);\n  },\n  methods: {\n    click() {\n      this.show = !this.show;\n      this.show && this.$refs.headerSearch && this.$refs.headerSearch.focus();\n    },\n    close() {\n      this.$refs.headerSearch && this.$refs.headerSearch.blur();\n      this.options = [];\n      this.show = false;\n    },\n    change(val) {\n      this.$router.push(val.item.path);\n      this.search = '';\n      this.options = [];\n      this.$nextTick(() => {\n        this.show = false;\n      });\n    },\n    initFuse(list) {\n      this.fuse = new Fuse(list, {\n        shouldSort: true,\n        threshold: 0.4,\n        location: 0,\n        distance: 100,\n        maxPatternLength: 10,\n        minMatchCharLength: 1,\n        keys: [{\n          name: 'title',\n          weight: 0.7\n        }, {\n          name: 'path',\n          weight: 0.3\n        }]\n      });\n    },\n    generateRoutes(routes, basePath = '/', prefixTitle = []) {\n      let res = [];\n      for (const router of routes) {\n        if (router.hidden) {\n          continue;\n        }\n        const data = {\n          path: path.resolve(basePath, router.path),\n          title: [...prefixTitle]\n        };\n        if (router.meta && router.meta.title) {\n          // 标题国际化\n          // const hasKey = i18n.te(`route.${router.meta.title}`)\n          // let i18nTitle\n          // if (hasKey) {\n          //   i18nTitle = i18n.t(`route.${router.meta.title}`)\n          // } else {\n          //   i18nTitle = router.meta.title\n          // }\n          const i18nTitle = router.meta.title;\n          data.title = [...data.title, i18nTitle];\n          if (router.redirect !== 'noredirect') {\n            res.push(data);\n          }\n        }\n        if (router.children) {\n          const tempRoutes = this.generateRoutes(router.children, data.path, data.title);\n          if (tempRoutes.length >= 1) {\n            res = [...res, ...tempRoutes];\n          }\n        }\n      }\n      return res;\n    },\n    querySearch(query) {\n      query && (this.options = this.fuse.search(query));\n      !query && (this.options = []);\n    }\n  }\n};","map":{"version":3,"names":["Fuse","path","name","props","allMenu","type","Array","default","data","search","options","searchPool","show","fuse","undefined","watch","list","initFuse","value","document","body","addEventListener","close","removeEventListener","mounted","generateRoutes","methods","click","$refs","headerSearch","focus","blur","change","val","$router","push","item","$nextTick","shouldSort","threshold","location","distance","maxPatternLength","minMatchCharLength","keys","weight","routes","basePath","prefixTitle","res","router","hidden","resolve","title","meta","i18nTitle","redirect","children","tempRoutes","length","querySearch","query"],"sources":["node_modules/@cndinfo/cube-design-web/src/components/NavRightMenu/src/components/HeaderSearch/index.vue"],"sourcesContent":["<template>\n  <div :class=\"['header-search', { 'show-search': show }]\">\n    <cnd-icon name=\"cnd-search\" @click.stop=\"click\" />\n    <el-select\n      ref=\"headerSearch\"\n      v-model=\"search\"\n      :remote-method=\"querySearch\"\n      filterable\n      default-first-option\n      remote\n      placeholder=\"Search\"\n      @change=\"change\"\n    >\n      <el-option\n        v-for=\"item in options\"\n        :key=\"item.path\"\n        :value=\"item\"\n        :label=\"item.item.title.join('>')\"\n      />\n    </el-select>\n  </div>\n</template>\n\n<script>\nimport Fuse from 'fuse.js'\nimport path from 'path'\n// import i18n from '@/lang'\n\nexport default {\n  name: 'HeaderSearch',\n  props: {\n    allMenu: {\n      type: Array,\n      default: () => []\n    }\n  },\n  data() {\n    return {\n      search: '',\n      options: [],\n      searchPool: [],\n      show: false,\n      fuse: undefined\n    }\n  },\n  // computed: {\n  //   lang () {\n  //     return this.$store.getters.language\n  //   }\n  // },\n  watch: {\n    // lang () {\n    //   this.searchPool = this.generateRoutes(this.allMenu)\n    // },\n    // routes () {\n    //   this.searchPool = this.generateRoutes(this.allMenu)\n    // },\n    searchPool(list) {\n      this.initFuse(list)\n    },\n    show(value) {\n      if (value) {\n        document.body.addEventListener('click', this.close)\n      } else {\n        document.body.removeEventListener('click', this.close)\n      }\n    }\n  },\n  mounted() {\n    this.searchPool = this.generateRoutes(this.allMenu)\n  },\n  methods: {\n    click() {\n      this.show = !this.show\n      this.show && this.$refs.headerSearch && this.$refs.headerSearch.focus()\n    },\n    close() {\n      this.$refs.headerSearch && this.$refs.headerSearch.blur()\n      this.options = []\n      this.show = false\n    },\n    change(val) {\n      this.$router.push(val.item.path)\n      this.search = ''\n      this.options = []\n      this.$nextTick(() => {\n        this.show = false\n      })\n    },\n    initFuse(list) {\n      this.fuse = new Fuse(list, {\n        shouldSort: true,\n        threshold: 0.4,\n        location: 0,\n        distance: 100,\n        maxPatternLength: 10,\n        minMatchCharLength: 1,\n        keys: [{\n          name: 'title',\n          weight: 0.7\n        }, {\n          name: 'path',\n          weight: 0.3\n        }]\n      })\n    },\n    generateRoutes(routes, basePath = '/', prefixTitle = []) {\n      let res = []\n      for (const router of routes) {\n        if (router.hidden) { continue }\n\n        const data = {\n          path: path.resolve(basePath, router.path),\n          title: [...prefixTitle]\n        }\n\n        if (router.meta && router.meta.title) {\n          // 标题国际化\n          // const hasKey = i18n.te(`route.${router.meta.title}`)\n          // let i18nTitle\n          // if (hasKey) {\n          //   i18nTitle = i18n.t(`route.${router.meta.title}`)\n          // } else {\n          //   i18nTitle = router.meta.title\n          // }\n          const i18nTitle = router.meta.title\n          data.title = [...data.title, i18nTitle]\n\n          if (router.redirect !== 'noredirect') {\n            res.push(data)\n          }\n        }\n\n        if (router.children) {\n          const tempRoutes = this.generateRoutes(router.children, data.path, data.title)\n          if (tempRoutes.length >= 1) {\n            res = [...res, ...tempRoutes]\n          }\n        }\n      }\n      return res\n    },\n    querySearch(query) {\n      query && (this.options = this.fuse.search(query))\n      !query && (this.options = [])\n    }\n  }\n}\n</script>\n\n"],"mappings":";AAwBA,OAAAA,IAAA;AACA,OAAAC,IAAA;AACA;;AAEA;EACAC,IAAA;EACAC,KAAA;IACAC,OAAA;MACAC,IAAA,EAAAC,KAAA;MACAC,OAAA,EAAAA,CAAA;IACA;EACA;EACAC,KAAA;IACA;MACAC,MAAA;MACAC,OAAA;MACAC,UAAA;MACAC,IAAA;MACAC,IAAA,EAAAC;IACA;EACA;EACA;EACA;EACA;EACA;EACA;EACAC,KAAA;IACA;IACA;IACA;IACA;IACA;IACA;IACAJ,WAAAK,IAAA;MACA,KAAAC,QAAA,CAAAD,IAAA;IACA;IACAJ,KAAAM,KAAA;MACA,IAAAA,KAAA;QACAC,QAAA,CAAAC,IAAA,CAAAC,gBAAA,eAAAC,KAAA;MACA;QACAH,QAAA,CAAAC,IAAA,CAAAG,mBAAA,eAAAD,KAAA;MACA;IACA;EACA;EACAE,QAAA;IACA,KAAAb,UAAA,QAAAc,cAAA,MAAArB,OAAA;EACA;EACAsB,OAAA;IACAC,MAAA;MACA,KAAAf,IAAA,SAAAA,IAAA;MACA,KAAAA,IAAA,SAAAgB,KAAA,CAAAC,YAAA,SAAAD,KAAA,CAAAC,YAAA,CAAAC,KAAA;IACA;IACAR,MAAA;MACA,KAAAM,KAAA,CAAAC,YAAA,SAAAD,KAAA,CAAAC,YAAA,CAAAE,IAAA;MACA,KAAArB,OAAA;MACA,KAAAE,IAAA;IACA;IACAoB,OAAAC,GAAA;MACA,KAAAC,OAAA,CAAAC,IAAA,CAAAF,GAAA,CAAAG,IAAA,CAAAnC,IAAA;MACA,KAAAQ,MAAA;MACA,KAAAC,OAAA;MACA,KAAA2B,SAAA;QACA,KAAAzB,IAAA;MACA;IACA;IACAK,SAAAD,IAAA;MACA,KAAAH,IAAA,OAAAb,IAAA,CAAAgB,IAAA;QACAsB,UAAA;QACAC,SAAA;QACAC,QAAA;QACAC,QAAA;QACAC,gBAAA;QACAC,kBAAA;QACAC,IAAA;UACA1C,IAAA;UACA2C,MAAA;QACA;UACA3C,IAAA;UACA2C,MAAA;QACA;MACA;IACA;IACApB,eAAAqB,MAAA,EAAAC,QAAA,QAAAC,WAAA;MACA,IAAAC,GAAA;MACA,WAAAC,MAAA,IAAAJ,MAAA;QACA,IAAAI,MAAA,CAAAC,MAAA;UAAA;QAAA;QAEA,MAAA3C,IAAA;UACAP,IAAA,EAAAA,IAAA,CAAAmD,OAAA,CAAAL,QAAA,EAAAG,MAAA,CAAAjD,IAAA;UACAoD,KAAA,MAAAL,WAAA;QACA;QAEA,IAAAE,MAAA,CAAAI,IAAA,IAAAJ,MAAA,CAAAI,IAAA,CAAAD,KAAA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA,MAAAE,SAAA,GAAAL,MAAA,CAAAI,IAAA,CAAAD,KAAA;UACA7C,IAAA,CAAA6C,KAAA,OAAA7C,IAAA,CAAA6C,KAAA,EAAAE,SAAA;UAEA,IAAAL,MAAA,CAAAM,QAAA;YACAP,GAAA,CAAAd,IAAA,CAAA3B,IAAA;UACA;QACA;QAEA,IAAA0C,MAAA,CAAAO,QAAA;UACA,MAAAC,UAAA,QAAAjC,cAAA,CAAAyB,MAAA,CAAAO,QAAA,EAAAjD,IAAA,CAAAP,IAAA,EAAAO,IAAA,CAAA6C,KAAA;UACA,IAAAK,UAAA,CAAAC,MAAA;YACAV,GAAA,OAAAA,GAAA,KAAAS,UAAA;UACA;QACA;MACA;MACA,OAAAT,GAAA;IACA;IACAW,YAAAC,KAAA;MACAA,KAAA,UAAAnD,OAAA,QAAAG,IAAA,CAAAJ,MAAA,CAAAoD,KAAA;MACA,CAAAA,KAAA,UAAAnD,OAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}