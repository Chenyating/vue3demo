{"ast":null,"code":"import _mergeJSXProps from \"@vue/babel-helper-vue-jsx-merge-props\";\nimport \"core-js/modules/es.array.push.js\";\nimport TabNav from './tab-nav';\nimport '../../../../lib/styles/components/Tabs.scss';\nexport default {\n  name: 'Tabs',\n  components: {\n    TabNav\n  },\n  provide() {\n    return {\n      rootTabs: this\n    };\n  },\n  props: {\n    type: String,\n    activeName: String,\n    closable: Boolean,\n    addable: Boolean,\n    value: {},\n    editable: Boolean,\n    tabPosition: {\n      type: String,\n      default: 'top'\n    },\n    beforeLeave: Function,\n    stretch: Boolean,\n    // 头部样式 default/full full:为铺满白底\n    headerType: {\n      type: String,\n      default: 'default'\n    },\n    size: {\n      type: String\n    }\n  },\n  data() {\n    return {\n      currentName: this.value || this.activeName,\n      panes: []\n    };\n  },\n  computed: {\n    isColumn() {\n      return ['top', 'bottom'].indexOf(this.tabPosition) !== -1;\n    }\n  },\n  watch: {\n    activeName(value) {\n      this.setCurrentName(value);\n    },\n    value(value) {\n      this.setCurrentName(value);\n    },\n    currentName(value) {\n      if (this.$refs.nav) {\n        this.$nextTick(() => {\n          this.$refs.nav.$nextTick(_ => {\n            this.$refs.nav.scrollToActiveTab();\n          });\n        });\n      }\n    }\n  },\n  created() {\n    if (!this.currentName) {\n      this.setCurrentName('0');\n    }\n    this.$on('tab-nav-update', this.calcPaneInstances.bind(null, true));\n  },\n  mounted() {\n    this.calcPaneInstances();\n  },\n  updated() {\n    this.calcPaneInstances();\n  },\n  methods: {\n    calcPaneInstances(isForceUpdate = false) {\n      if (this.$slots.default) {\n        const paneSlots = this.$slots.default.filter(vnode => vnode.tag && vnode.componentOptions && vnode.componentOptions.Ctor.options.name === 'TabPane');\n        // update indeed\n        const panes = paneSlots.map(({\n          componentInstance\n        }) => componentInstance);\n        const panesChanged = !(panes.length === this.panes.length && panes.every((pane, index) => pane === this.panes[index]));\n        if (isForceUpdate || panesChanged) {\n          this.panes = panes;\n        }\n      } else if (this.panes.length !== 0) {\n        this.panes = [];\n      }\n    },\n    handleTabClick(tab, tabName, event) {\n      if (tab.disabled) return;\n      this.setCurrentName(tabName);\n      this.$emit('tab-click', tab, event);\n    },\n    handleTabRemove(pane, ev) {\n      if (pane.disabled) return;\n      ev.stopPropagation();\n      this.$emit('edit', pane.name, 'remove');\n      this.$emit('tab-remove', pane.name);\n    },\n    handleTabAdd() {\n      this.$emit('edit', null, 'add');\n      this.$emit('tab-add');\n    },\n    setCurrentName(value) {\n      const changeCurrentName = () => {\n        this.currentName = value;\n        this.$emit('input', value);\n      };\n      if (this.currentName !== value && this.beforeLeave) {\n        const before = this.beforeLeave(value, this.currentName);\n        if (before && before.then) {\n          before.then(() => {\n            changeCurrentName();\n            this.$refs.nav && this.$refs.nav.removeFocus();\n          }, () => {\n            // https://github.com/ElemeFE/element/pull/14816\n            // ignore promise rejection in `before-leave` hook\n          });\n        } else if (before !== false) {\n          changeCurrentName();\n        }\n      } else {\n        changeCurrentName();\n      }\n    }\n  },\n  render(h) {\n    const {\n      type,\n      handleTabClick,\n      handleTabRemove,\n      handleTabAdd,\n      currentName,\n      panes,\n      editable,\n      addable,\n      tabPosition,\n      stretch,\n      size\n    } = this;\n    const newButton = editable || addable ? h(\"span\", {\n      \"class\": 'el-tabs__new-tab',\n      \"on\": {\n        \"click\": handleTabAdd,\n        \"keydown\": ev => {\n          if (ev.keyCode === 13) {\n            handleTabAdd();\n          }\n        }\n      },\n      \"attrs\": {\n        \"tabindex\": '0'\n      }\n    }, [h(\"i\", {\n      \"class\": 'el-icon-plus'\n    })]) : null;\n    const navData = {\n      props: {\n        currentName,\n        onTabClick: handleTabClick,\n        onTabRemove: handleTabRemove,\n        editable,\n        type,\n        panes,\n        stretch\n      },\n      ref: 'nav'\n    };\n    const headerClass = ['el-tabs__header', 'cube-tabs__header', `is-${tabPosition}`];\n    if (this.headerType === 'full') {\n      headerClass.push('el-tabs__header--full');\n    }\n    const header = h(\"div\", {\n      \"class\": headerClass\n    }, [newButton, h(\"tab-nav\", _mergeJSXProps([{}, navData]))]);\n    const panels = h(\"div\", {\n      \"class\": 'el-tabs__content cube-tabs__content'\n    }, [this.$slots.default]);\n    return h(\"div\", {\n      \"class\": {\n        'cube-tabs': true,\n        'tabs-container': true,\n        'flexV': this.isColumn,\n        'el-tabs': true,\n        'el-tabs--card': type === 'card',\n        [`el-tabs--${tabPosition}`]: true,\n        'el-tabs--border-card': type === 'border-card',\n        [`el-tabs--${size}`]: !!size\n      }\n    }, [tabPosition !== 'bottom' ? [header, panels] : [panels, header]]);\n  }\n};","map":{"version":3,"names":["TabNav","name","components","provide","rootTabs","props","type","String","activeName","closable","Boolean","addable","value","editable","tabPosition","default","beforeLeave","Function","stretch","headerType","size","data","currentName","panes","computed","isColumn","indexOf","watch","setCurrentName","$refs","nav","$nextTick","_","scrollToActiveTab","created","$on","calcPaneInstances","bind","mounted","updated","methods","isForceUpdate","$slots","paneSlots","filter","vnode","tag","componentOptions","Ctor","options","map","componentInstance","panesChanged","length","every","pane","index","handleTabClick","tab","tabName","event","disabled","$emit","handleTabRemove","ev","stopPropagation","handleTabAdd","changeCurrentName","before","then","removeFocus","render","h","newButton","keyCode","navData","onTabClick","onTabRemove","ref","headerClass","push","header","_mergeJSXProps","panels"],"sources":["node_modules/@cndinfo/cube-design-web/src/components/Tabs/src/tabs.vue"],"sourcesContent":["<script>\nimport TabNav from './tab-nav'\nimport '../../../../lib/styles/components/Tabs.scss'\n\nexport default {\n  name: 'Tabs',\n\n  components: {\n    TabNav\n  },\n\n  provide() {\n    return {\n      rootTabs: this\n    }\n  },\n\n  props: {\n    type: String,\n    activeName: String,\n    closable: Boolean,\n    addable: Boolean,\n    value: {},\n    editable: Boolean,\n    tabPosition: {\n      type: String,\n      default: 'top'\n    },\n    beforeLeave: Function,\n    stretch: Boolean,\n    // 头部样式 default/full full:为铺满白底\n    headerType: {\n      type: String,\n      default: 'default'\n    },\n    size: {\n      type: String\n    }\n  },\n\n  data() {\n    return {\n      currentName: this.value || this.activeName,\n      panes: []\n    }\n  },\n\n  computed: {\n    isColumn() {\n      return ['top', 'bottom'].indexOf(this.tabPosition) !== -1\n    }\n  },\n\n  watch: {\n    activeName(value) {\n      this.setCurrentName(value)\n    },\n    value(value) {\n      this.setCurrentName(value)\n    },\n    currentName(value) {\n      if (this.$refs.nav) {\n        this.$nextTick(() => {\n          this.$refs.nav.$nextTick(_ => {\n            this.$refs.nav.scrollToActiveTab()\n          })\n        })\n      }\n    }\n  },\n\n  created() {\n    if (!this.currentName) {\n      this.setCurrentName('0')\n    }\n\n    this.$on('tab-nav-update', this.calcPaneInstances.bind(null, true))\n  },\n\n  mounted() {\n    this.calcPaneInstances()\n  },\n\n  updated() {\n    this.calcPaneInstances()\n  },\n\n  methods: {\n    calcPaneInstances(isForceUpdate = false) {\n      if (this.$slots.default) {\n        const paneSlots = this.$slots.default.filter(vnode => vnode.tag &&\n            vnode.componentOptions && vnode.componentOptions.Ctor.options.name === 'TabPane')\n        // update indeed\n        const panes = paneSlots.map(({ componentInstance }) => componentInstance)\n        const panesChanged = !(panes.length === this.panes.length && panes.every((pane, index) => pane === this.panes[index]))\n        if (isForceUpdate || panesChanged) {\n          this.panes = panes\n        }\n      } else if (this.panes.length !== 0) {\n        this.panes = []\n      }\n    },\n    handleTabClick(tab, tabName, event) {\n      if (tab.disabled) return\n      this.setCurrentName(tabName)\n      this.$emit('tab-click', tab, event)\n    },\n    handleTabRemove(pane, ev) {\n      if (pane.disabled) return\n      ev.stopPropagation()\n      this.$emit('edit', pane.name, 'remove')\n      this.$emit('tab-remove', pane.name)\n    },\n    handleTabAdd() {\n      this.$emit('edit', null, 'add')\n      this.$emit('tab-add')\n    },\n    setCurrentName(value) {\n      const changeCurrentName = () => {\n        this.currentName = value\n        this.$emit('input', value)\n      }\n      if (this.currentName !== value && this.beforeLeave) {\n        const before = this.beforeLeave(value, this.currentName)\n        if (before && before.then) {\n          before\n            .then(() => {\n              changeCurrentName()\n              this.$refs.nav && this.$refs.nav.removeFocus()\n            }, () => {\n              // https://github.com/ElemeFE/element/pull/14816\n              // ignore promise rejection in `before-leave` hook\n            })\n        } else if (before !== false) {\n          changeCurrentName()\n        }\n      } else {\n        changeCurrentName()\n      }\n    }\n  },\n\n  render(h) {\n    const {\n      type,\n      handleTabClick,\n      handleTabRemove,\n      handleTabAdd,\n      currentName,\n      panes,\n      editable,\n      addable,\n      tabPosition,\n      stretch,\n      size\n    } = this\n\n    const newButton = editable || addable\n      ? (\n        <span\n          class='el-tabs__new-tab'\n          on-click={ handleTabAdd }\n          tabindex='0'\n          on-keydown={ (ev) => { if (ev.keyCode === 13) { handleTabAdd() } } }\n        >\n          <i class='el-icon-plus'></i>\n        </span>\n      )\n      : null\n\n    const navData = {\n      props: {\n        currentName,\n        onTabClick: handleTabClick,\n        onTabRemove: handleTabRemove,\n        editable,\n        type,\n        panes,\n        stretch\n      },\n      ref: 'nav'\n    }\n    const headerClass = ['el-tabs__header', 'cube-tabs__header', `is-${tabPosition}`]\n    if (this.headerType === 'full') {\n      headerClass.push('el-tabs__header--full')\n    }\n    const header = (\n      <div class={headerClass}>\n        {newButton}\n        <tab-nav { ...navData }></tab-nav>\n      </div>\n    )\n    const panels = (\n      <div class='el-tabs__content cube-tabs__content'>\n        {this.$slots.default}\n      </div>\n    )\n\n    return (\n      <div class={{\n        'cube-tabs': true,\n        'tabs-container': true,\n        'flexV': this.isColumn,\n        'el-tabs': true,\n        'el-tabs--card': type === 'card',\n        [`el-tabs--${tabPosition}`]: true,\n        'el-tabs--border-card': type === 'border-card',\n        [`el-tabs--${size}`]: !!size\n      }}>\n        { tabPosition !== 'bottom' ? [header, panels] : [panels, header] }\n      </div>\n    )\n  }\n}\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}