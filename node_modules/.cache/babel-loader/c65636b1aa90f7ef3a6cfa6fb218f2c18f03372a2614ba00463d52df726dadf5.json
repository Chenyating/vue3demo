{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport _ from \"lodash\";\nimport $$Rangers from \"@datarangers/sdk-mp\"; // 火山微信小程序的sdk\nimport $router from \"../common/uni-router\";\nimport { Volcengine } from \"../common\";\nimport { checkInitParams } from \"./validate\";\nexport default class WxmpVolcengine extends Volcengine {\n  constructor(param) {\n    const initParams = _.isEmpty(param) ? {} : _.isObject(param) ? param : {};\n    initParams.type = 2;\n    // 表示是微信小程序端的SDK\n    super(initParams);\n    try {\n      this.wxmpPlugins = $$Rangers;\n      this.routerInfo = UNI_ROUTES.pages;\n      this.tarBar = UNI_ROUTES.tarBar ? UNI_ROUTES.tarBar.list : [];\n      this.isInitWXMPSdk = false;\n      this.initWXMPSdk(param);\n    } catch (e) {}\n  }\n  // 开始写入路由、访问时间、访问路径的缓存到系统缓存中\n  start() {\n    if (this.isInitWXMPSdk) {\n      if (UNI_ROUTES.subPackages) {\n        this.handleSubPackagesList(UNI_ROUTES.subPackages);\n      }\n      this.init(this.routerInfo, this.tarBar);\n    }\n  }\n\n  // 监听路由变更\n  listenRouter(param) {\n    if (this.isInitWXMPSdk) {\n      if (!_.isObject(param)) {\n        param = {};\n      }\n      $router.onchange = (n, o) => {\n        if (!this.isVolcengine) {\n          return;\n        }\n        try {\n          const lastVisitUrl = this.getCacheVisitUrl();\n          const nowPath = n.fullPath;\n          if (lastVisitUrl === nowPath) {\n            return;\n          }\n          this.setCacheVisitUrl(nowPath);\n          this.customPageview(o.fullPath, param);\n        } catch (e) {}\n      };\n    }\n  }\n\n  // 初始化\n  initWXMPSdk(param) {\n    const isValid = checkInitParams(param);\n    if (isValid) {\n      if (!param.enable_profile) {\n        param.enable_profile = true;\n      }\n      if (!param.enable_filter_crawler) {\n        param.enable_filter_crawler = true;\n      }\n      this.wxmpPlugins.init(param);\n      this.wxmpPlugins.send();\n      this.isInitWXMPSdk = true;\n    }\n  }\n\n  /**\n   * 接口采集事件\n   * @param {*} param\n   */\n  collectApi(param) {\n    if (!this.isInitWXMPSdk) {\n      return;\n    }\n    const pages = this.getCurrentPagesArr();\n    this.changeCurrentPage(pages);\n    const currentUrl = this.pages[0];\n    const commonAttr = this.getCommonAttr(currentUrl);\n    const collectParam = {};\n    Object.keys(param).forEach(key => {\n      let targetKey = key;\n      if ([\"apiName\", \"isSuccess\", \"apiTimeCost\"].includes(key)) {\n        targetKey = key.replace(/[A-Z]/g, key => `_${key.toLowerCase()}`);\n      }\n      collectParam[targetKey] = param[key];\n    });\n    const finalParam = {\n      ...commonAttr,\n      ...collectParam\n    };\n    this.wxmpPlugins.event(\"api_request\", finalParam);\n  }\n  customPageviewLaunch(param) {\n    if (this.getIsLaunch() || this.getIsHide()) {\n      const currentUrl = this.getCacheVisitUrl();\n      this.setIsHide(false);\n      this.customPageview(currentUrl, param);\n    }\n    this.setIsLaunch(true);\n  }\n  customPageviewOpen(param) {\n    const that = this;\n    this.setIsLaunch(true); // 不然会出现关闭之后进入首页在刷新，没有上报停留时间\n    setTimeout(function () {\n      that.setIsHide(false);\n      that.handleCustomPageviewOpen(param);\n    }, 500);\n  }\n  // 监听初始化进入页面\n  handleCustomPageviewOpen(param) {\n    if (!this.isInitWXMPSdk) {\n      return;\n    }\n    if (!_.isObject(param)) {\n      param = {};\n    }\n    try {\n      const pages = this.getCurrentPagesArr();\n      this.changeCurrentPage(pages);\n      let currentUrl;\n      if (this.pages.length > 0) {\n        currentUrl = this.pages[0];\n      } else {\n        // 获取不到当前页面只能取首页了\n        currentUrl = \"/\" + this.routerInfo[0].path;\n      }\n      const nowTime = new Date().getTime();\n      this.setCacheTime(nowTime); // 重新记录页面停留时间\n      this.setCacheVisitUrl(currentUrl);\n      if (!this.volcengineProps[currentUrl]) {\n        this.updateRouter(this.routerInfo, this.tarBar);\n      }\n      const commonAttr = this.getCommonAttr(currentUrl);\n      const finalParam = {\n        ...commonAttr,\n        ...param\n      };\n      this.wxmpPlugins.event(\"custom_pageview_open\", finalParam);\n    } catch (e) {}\n  }\n\n  /**\n   * 监听隐藏页面\n   * @param\n   * @returns\n   */\n  customPageviewHide(param) {\n    try {\n      if (!_.isObject(param)) {\n        param = {};\n      }\n      const pages = this.getCurrentPagesArr();\n      this.changeCurrentPage(pages);\n      let currentUrl = this.getCacheVisitUrl();\n      if (this.pages.length > 0) {\n        currentUrl = this.pages[0];\n      }\n      // 如果没有任何匹配的，那就是首页\n      if (!currentUrl) {\n        currentUrl = \"/\" + this.routerInfo[0].path;\n      }\n      if (!this.volcengineProps[currentUrl]) {\n        this.updateRouter(this.routerInfo, this.tarBar);\n      }\n      const commonAttr = this.getCommonAttr(currentUrl);\n      const finalParam = {\n        ...commonAttr,\n        ...param\n      };\n      this.wxmpPlugins.event(\"custom_pageview_hide\", finalParam);\n      // 上报当前页面的停留时间，然后onShow的时候会重新改写当前页面访问时间\n      this.customPageview(currentUrl, param);\n      this.setIsLaunch(false);\n      this.setIsHide(true);\n    } catch (e) {}\n  }\n  /**\n   * 用户上报火山自定义事件\n   * @param {*} name 自定义的事件名称\n   * @param {*} param 自定义的事件参数\n   * @returns\n   */\n  reportEvent(name, param) {\n    // 防止 自定义 custom_pageview 事件的时候没有执行对应逻辑\n    const oldPath = this.pages && this.pages.length ? this.pages[0] : this.routerInfo[0].path;\n    const pages = this.getCurrentPagesArr();\n    this.changeCurrentPage(pages);\n    const currentUrl = this.pages[0];\n    if (name === \"custom_pageview\") {\n      this.setCacheVisitUrl(oldPath, param);\n    }\n    const commonAttr = this.getCommonAttr(currentUrl);\n    const finalParam = {\n      ...commonAttr,\n      ...param\n    };\n    try {\n      this.wxmpPlugins.event(name, finalParam);\n    } catch (e) {}\n  }\n  setUserUniqueId(paramUserUniqueId) {\n    if (!this.isInitWXMPSdk) {\n      return;\n    }\n    const userUniqueId = paramUserUniqueId || this.nullProp;\n    try {\n      this.wxmpPlugins.setUserUniqueID(userUniqueId);\n    } catch (e) {}\n  }\n\n  /**\n   * 设置用户属性\n   * @param {*} profileParam 用户属性\n   * @returns\n   */\n  profileSet(profileParam) {\n    try {\n      this.wxmpPlugins.profileSet(profileParam);\n    } catch (e) {}\n  }\n  sdkVersionProfileSet(param) {\n    try {\n      const sdkVersion = this.getSdkVersion();\n      const finalParam = {\n        ...param,\n        ...sdkVersion\n      };\n      this.profileSet(finalParam);\n    } catch (e) {}\n  }\n  appVersionProfileSet(param) {\n    try {\n      const appVersion = this.getAppVersion();\n      const finalParam = {\n        ...param,\n        ...appVersion\n      };\n      this.profileSet(finalParam);\n    } catch (e) {}\n  }\n\n  /**\n   * 上报页面访问事件\n   * @param {*} path 路径\n   * @param {*} param 用户自定义的参数\n   */\n  customPageview(path, param) {\n    if (!this.volcengineProps[path]) {\n      this.updateRouter(this.routerInfo, this.tarBar);\n    }\n    const lastPageVisitTime = this.getCacheTime();\n    const nowTime = new Date().getTime();\n    this.setCacheTime(nowTime);\n    const commonAttr = this.getCommonAttr(path);\n    const isHide = this.getIsHide();\n    const durationParam = {\n      custom_page_duration: isHide ? 0 : nowTime - lastPageVisitTime\n    };\n    const finalParam = {\n      ...commonAttr,\n      ...durationParam,\n      ...param\n    };\n    this.setIsHide(false);\n    this.wxmpPlugins.event(\"custom_pageview\", finalParam);\n  }\n  handleSubPackagesList(packageList) {\n    packageList.forEach(element => {\n      const rootPath = element.root + \"/\";\n      if (element.pages && element.pages.length) {\n        element.pages.forEach(item => {\n          const subItem = item;\n          subItem.path = rootPath + item.path;\n          this.routerInfo.push(subItem);\n        });\n      }\n    });\n  }\n}","map":{"version":3,"names":["_","$$Rangers","$router","Volcengine","checkInitParams","WxmpVolcengine","constructor","param","initParams","isEmpty","isObject","type","wxmpPlugins","routerInfo","UNI_ROUTES","pages","tarBar","list","isInitWXMPSdk","initWXMPSdk","e","start","subPackages","handleSubPackagesList","init","listenRouter","onchange","n","o","isVolcengine","lastVisitUrl","getCacheVisitUrl","nowPath","fullPath","setCacheVisitUrl","customPageview","isValid","enable_profile","enable_filter_crawler","send","collectApi","getCurrentPagesArr","changeCurrentPage","currentUrl","commonAttr","getCommonAttr","collectParam","Object","keys","forEach","key","targetKey","includes","replace","toLowerCase","finalParam","event","customPageviewLaunch","getIsLaunch","getIsHide","setIsHide","setIsLaunch","customPageviewOpen","that","setTimeout","handleCustomPageviewOpen","length","path","nowTime","Date","getTime","setCacheTime","volcengineProps","updateRouter","customPageviewHide","reportEvent","name","oldPath","setUserUniqueId","paramUserUniqueId","userUniqueId","nullProp","setUserUniqueID","profileSet","profileParam","sdkVersionProfileSet","sdkVersion","getSdkVersion","appVersionProfileSet","appVersion","getAppVersion","lastPageVisitTime","getCacheTime","isHide","durationParam","custom_page_duration","packageList","element","rootPath","root","item","subItem","push"],"sources":["/Users/myproject/vuedemo/node_modules/@cndinfo/cube-design-web/node_modules/@cndinfo/cube-analytics-sdk/wxmp/index.js"],"sourcesContent":["import _ from \"lodash\"\nimport $$Rangers from \"@datarangers/sdk-mp\" // 火山微信小程序的sdk\nimport $router from \"../common/uni-router\"\nimport { Volcengine } from \"../common\"\nimport { checkInitParams } from \"./validate\"\nexport default class WxmpVolcengine extends Volcengine {\n  constructor(param) {\n    const initParams = _.isEmpty(param) ? {} : _.isObject(param) ? param : {}\n    initParams.type = 2\n    // 表示是微信小程序端的SDK\n    super(initParams)\n    try {\n      this.wxmpPlugins = $$Rangers\n      this.routerInfo = UNI_ROUTES.pages\n      this.tarBar = UNI_ROUTES.tarBar ? UNI_ROUTES.tarBar.list : []\n      this.isInitWXMPSdk = false\n      this.initWXMPSdk(param)\n    } catch (e) {\n    }\n  }\n  // 开始写入路由、访问时间、访问路径的缓存到系统缓存中\n  start() {\n    if (this.isInitWXMPSdk) {\n      if (UNI_ROUTES.subPackages) {\n        this.handleSubPackagesList(UNI_ROUTES.subPackages)\n      }\n      this.init(this.routerInfo, this.tarBar)\n    }\n  }\n\n  // 监听路由变更\n  listenRouter(param) {\n    if (this.isInitWXMPSdk) {\n      if (!_.isObject(param)) {\n        param = {}\n      }\n      $router.onchange = (n, o) => {\n        if (!this.isVolcengine) {\n          return\n        }\n        try {\n          const lastVisitUrl = this.getCacheVisitUrl()\n          const nowPath = n.fullPath\n          if (lastVisitUrl === nowPath) {\n            return\n          }\n          this.setCacheVisitUrl(nowPath)\n          this.customPageview(o.fullPath, param)\n        } catch (e) {}\n      }\n    }\n  }\n\n  // 初始化\n  initWXMPSdk(param) {\n    const isValid = checkInitParams(param)\n    if (isValid) {\n      if (!param.enable_profile) {\n        param.enable_profile = true\n      }\n      if (!param.enable_filter_crawler) {\n        param.enable_filter_crawler = true\n      }\n      this.wxmpPlugins.init(param)\n      this.wxmpPlugins.send()\n      this.isInitWXMPSdk = true\n    }\n  }\n\n  /**\n   * 接口采集事件\n   * @param {*} param\n   */\n  collectApi(param) {\n    if (!this.isInitWXMPSdk) {\n      return\n    }\n    const pages = this.getCurrentPagesArr()\n    this.changeCurrentPage(pages)\n    const currentUrl = this.pages[0]\n    const commonAttr = this.getCommonAttr(currentUrl)\n    const collectParam = {}\n    Object.keys(param).forEach((key) => {\n      let targetKey = key\n      if ([\"apiName\", \"isSuccess\", \"apiTimeCost\"].includes(key)) {\n        targetKey = key.replace(\n          /[A-Z]/g,\n          (key) => `_${key.toLowerCase()}`\n        )\n      }\n      collectParam[targetKey] = param[key]\n    })\n    const finalParam = {\n      ...commonAttr,\n      ...collectParam\n    }\n    this.wxmpPlugins.event(\"api_request\", finalParam)\n  }\n  customPageviewLaunch(param) {\n    if (this.getIsLaunch() || this.getIsHide()) {\n      const currentUrl = this.getCacheVisitUrl()\n      this.setIsHide(false)\n      this.customPageview(currentUrl, param)\n    }\n    this.setIsLaunch(true)\n  }\n  customPageviewOpen(param) {\n    const that = this\n    this.setIsLaunch(true) // 不然会出现关闭之后进入首页在刷新，没有上报停留时间\n    setTimeout(function() {\n      that.setIsHide(false)\n      that.handleCustomPageviewOpen(param)\n    }, 500)\n  }\n  // 监听初始化进入页面\n  handleCustomPageviewOpen(param) {\n    if (!this.isInitWXMPSdk) {\n      return\n    }\n    if (!_.isObject(param)) {\n      param = {}\n    }\n    try {\n      const pages = this.getCurrentPagesArr()\n      this.changeCurrentPage(pages)\n      let currentUrl\n      if (this.pages.length > 0) {\n        currentUrl = this.pages[0]\n      } else {\n        // 获取不到当前页面只能取首页了\n        currentUrl = \"/\" + this.routerInfo[0].path\n      }\n      const nowTime = new Date().getTime()\n      this.setCacheTime(nowTime) // 重新记录页面停留时间\n      this.setCacheVisitUrl(currentUrl)\n\n      if (!this.volcengineProps[currentUrl]) {\n        this.updateRouter(this.routerInfo, this.tarBar)\n      }\n\n      const commonAttr = this.getCommonAttr(currentUrl)\n      const finalParam = {\n        ...commonAttr,\n        ...param\n      }\n      this.wxmpPlugins.event(\"custom_pageview_open\", finalParam)\n    } catch (e) {\n    }\n  }\n\n  /**\n   * 监听隐藏页面\n   * @param\n   * @returns\n   */\n  customPageviewHide(param) {\n    try {\n      if (!_.isObject(param)) {\n        param = {}\n      }\n      const pages = this.getCurrentPagesArr()\n      this.changeCurrentPage(pages)\n      let currentUrl = this.getCacheVisitUrl()\n      if (this.pages.length > 0) {\n        currentUrl = this.pages[0]\n      }\n      // 如果没有任何匹配的，那就是首页\n      if (!currentUrl) {\n        currentUrl = \"/\" + this.routerInfo[0].path\n      }\n\n      if (!this.volcengineProps[currentUrl]) {\n        this.updateRouter(this.routerInfo, this.tarBar)\n      }\n      const commonAttr = this.getCommonAttr(currentUrl)\n      const finalParam = {\n        ...commonAttr,\n        ...param\n      }\n\n      this.wxmpPlugins.event(\"custom_pageview_hide\", finalParam)\n      // 上报当前页面的停留时间，然后onShow的时候会重新改写当前页面访问时间\n      this.customPageview(currentUrl, param)\n      this.setIsLaunch(false)\n      this.setIsHide(true)\n    } catch (e) {\n    }\n  }\n  /**\n   * 用户上报火山自定义事件\n   * @param {*} name 自定义的事件名称\n   * @param {*} param 自定义的事件参数\n   * @returns\n   */\n  reportEvent(name, param) {\n    // 防止 自定义 custom_pageview 事件的时候没有执行对应逻辑\n    const oldPath =\n      this.pages && this.pages.length ? this.pages[0] : this.routerInfo[0].path\n    const pages = this.getCurrentPagesArr()\n    this.changeCurrentPage(pages)\n    const currentUrl = this.pages[0]\n    if (name === \"custom_pageview\") {\n      this.setCacheVisitUrl(oldPath, param)\n    }\n    const commonAttr = this.getCommonAttr(currentUrl)\n    const finalParam = {\n      ...commonAttr,\n      ...param\n    }\n    try {\n      this.wxmpPlugins.event(name, finalParam)\n    } catch (e) {}\n  }\n\n  setUserUniqueId(paramUserUniqueId) {\n    if (!this.isInitWXMPSdk) {\n      return\n    }\n    const userUniqueId = paramUserUniqueId || this.nullProp\n    try {\n      this.wxmpPlugins.setUserUniqueID(userUniqueId)\n    } catch (e) {}\n  }\n\n  /**\n   * 设置用户属性\n   * @param {*} profileParam 用户属性\n   * @returns\n   */\n  profileSet(profileParam) {\n    try {\n      this.wxmpPlugins.profileSet(profileParam)\n    } catch (e) {}\n  }\n  sdkVersionProfileSet(param) {\n    try {\n      const sdkVersion = this.getSdkVersion()\n      const finalParam = {\n        ...param,\n        ...sdkVersion\n      }\n      this.profileSet(finalParam)\n    } catch (e) {}\n  }\n\n  appVersionProfileSet(param) {\n    try {\n      const appVersion = this.getAppVersion()\n      const finalParam = {\n        ...param,\n        ...appVersion\n      }\n      this.profileSet(finalParam)\n    } catch (e) {}\n  }\n\n  /**\n   * 上报页面访问事件\n   * @param {*} path 路径\n   * @param {*} param 用户自定义的参数\n   */\n  customPageview(path, param) {\n    if (!this.volcengineProps[path]) {\n      this.updateRouter(this.routerInfo, this.tarBar)\n    }\n    const lastPageVisitTime = this.getCacheTime()\n    const nowTime = new Date().getTime()\n    this.setCacheTime(nowTime)\n    const commonAttr = this.getCommonAttr(path)\n    const isHide = this.getIsHide()\n    const durationParam = {\n      custom_page_duration: isHide ? 0 : (nowTime - lastPageVisitTime)\n    }\n    const finalParam = {\n      ...commonAttr,\n      ...durationParam,\n      ...param\n    }\n    this.setIsHide(false)\n    this.wxmpPlugins.event(\"custom_pageview\", finalParam)\n  }\n  handleSubPackagesList(packageList) {\n    packageList.forEach((element) => {\n      const rootPath = element.root + \"/\"\n      if (element.pages && element.pages.length) {\n        element.pages.forEach((item) => {\n          const subItem = item\n          subItem.path = rootPath + item.path\n          this.routerInfo.push(subItem)\n        })\n      }\n    })\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}