{"ast":null,"code":"import \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport componentConfig from './componentColor.json';\nimport '../../../../lib/styles/components/ThemeEditor.scss';\nexport default {\n  props: {\n    showEditor: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      visible: this.showEditor,\n      colorConfig: '',\n      componentStyle: ''\n    };\n  },\n  computed: {},\n  watch: {\n    showEditor(newVal, oldVal) {\n      this.visible = newVal;\n      var localStorageConfig = JSON.parse(localStorage.getItem('colorStyle'));\n      if (localStorageConfig !== null) {\n        this.colorConfig = localStorageConfig.saveConfig;\n        this.componentStyle = {\n          root: localStorageConfig.saveStyles\n        };\n        this.$emit('getComponentStyle', {\n          type: 'color',\n          saveStyles: this.componentStyle.root\n        });\n      } else {\n        this.colorConfig = this.resetConfig(componentConfig);\n      }\n    }\n  },\n  mounted() {\n    var localStorageConfig = JSON.parse(localStorage.getItem('colorStyle'));\n    if (localStorageConfig !== null) {\n      this.colorConfig = localStorageConfig.saveConfig;\n    } else {\n      this.colorConfig = this.resetConfig(componentConfig);\n    }\n  },\n  methods: {\n    resetConfig(colorConfig) {\n      var config = JSON.parse(JSON.stringify(colorConfig));\n      config.forEach(item => {\n        item.group.forEach(group => {\n          group.editorKey = '';\n          group.oldKey = group.curKey;\n        });\n      });\n      return config;\n    },\n    closeDrawer() {\n      this.$emit('ifEditor', 'color', false);\n    },\n    changeCurKey(index, groupIndex, color) {\n      this.colorConfig[index].group[groupIndex].curKey = color;\n      this.componentStyle = this.getcss(this.colorConfig);\n      this.$emit('getComponentStyle', {\n        type: 'color',\n        saveStyles: this.componentStyle.root\n      });\n    },\n    getcss(config) {\n      const result = {};\n      for (let i = 0; i < config.length; i++) {\n        const group = config[i].group;\n        for (let j = 0; j < group.length; j++) {\n          const curKey = group[j].curKey;\n          const cssVariables = group[j].cssVariable;\n          for (let k = 0; k < cssVariables.length; k++) {\n            if (curKey !== group[j].oldKey) {\n              result[cssVariables[k]] = curKey;\n            }\n          }\n        }\n      }\n      var root = '';\n      var ag = '';\n      for (const [key, value] of Object.entries(result)) {\n        if (key.startsWith('--ag')) {\n          ag += `${key}: ${value};`;\n        } else {\n          root += `${key}: ${value};`;\n        }\n      }\n      // 动态ag插入style\n      const el = document.getElementsByClassName('ag-theme-balham');\n      const agSpace = localStorage.getItem('agSpaceStyle') != null ? localStorage.getItem('agSpaceStyle') : '';\n      const agStyle = ag + agSpace;\n      for (let i = 0; i < el.length; i++) {\n        this.$nextTick(() => {\n          el[i].style = agStyle;\n        });\n      }\n      return {\n        root,\n        ag\n      };\n    },\n    saveCSS() {\n      if (this.componentStyle !== '') {\n        var saveConfig = this.colorConfig;\n        var saveStyles = this.componentStyle.root;\n        var obj = {\n          saveStyles,\n          saveConfig\n        };\n        localStorage.setItem('colorStyle', JSON.stringify(obj));\n        localStorage.setItem('agColorStyle', this.getcss(this.colorConfig).ag);\n        this.$emit('getComponentStyle', {\n          type: 'color',\n          saveStyles\n        });\n      }\n      this.$emit('ifEditor', 'color', false);\n    },\n    downloadCss() {\n      var css = this.getcss(this.colorConfig);\n      var cont = `\n     .body.theme-name{\n      // 此处theme-name为主题名\n        ${css.root}\n          .ag-theme-balham {\n            ${css.ag}\n          }\n      }`;\n      var aTag = document.createElement('a');\n      var blob = new Blob([cont]);\n      aTag.download = 'componentStyle.scss';\n      aTag.href = URL.createObjectURL(blob);\n      aTag.click();\n      URL.revokeObjectURL(blob);\n    },\n    resetCss() {\n      this.colorConfig = this.resetConfig(componentConfig);\n      this.componentStyle = '';\n      this.$emit('getComponentStyle', {\n        type: 'color',\n        saveStyle: this.componentStyle.root\n      });\n      window.localStorage.removeItem('componentStyle');\n    }\n  }\n};","map":{"version":3,"names":["componentConfig","props","showEditor","type","Boolean","default","data","visible","colorConfig","componentStyle","computed","watch","newVal","oldVal","localStorageConfig","JSON","parse","localStorage","getItem","saveConfig","root","saveStyles","$emit","resetConfig","mounted","methods","config","stringify","forEach","item","group","editorKey","oldKey","curKey","closeDrawer","changeCurKey","index","groupIndex","color","getcss","result","i","length","j","cssVariables","cssVariable","k","ag","key","value","Object","entries","startsWith","el","document","getElementsByClassName","agSpace","agStyle","$nextTick","style","saveCSS","obj","setItem","downloadCss","css","cont","aTag","createElement","blob","Blob","download","href","URL","createObjectURL","click","revokeObjectURL","resetCss","saveStyle","window","removeItem"],"sources":["node_modules/@cndinfo/cube-design-web/src/components/ThemeEditor/src/editorColor.vue"],"sourcesContent":["<template>\n  <cube-drawer\n    title=\"自定义组件配色\"\n    :visible=\"visible\"\n    :size=\"'20%'\"\n    :modal=\"true\"\n    custom-class=\"drawerEditor\"\n    @close=\"closeDrawer\"\n  >\n    <div class=\"drawerEditor-body\">\n      <el-row v-for=\"(item, index) in colorConfig\" :key=\"index\">\n        <el-col class=\"editor-tit\">{{ item.groupName }}</el-col>\n        <el-form>\n          <el-form-item\n            v-for=\"(groupItem, groupIndex) in item.group\"\n            :key=\"groupIndex\"\n            :label=\"groupItem.name\"\n          >\n            <div\n              v-for=\"(color, colorIndex) in groupItem.key\"\n              :key=\"colorIndex\"\n              class=\"color-bar\"\n              :class=\"{ cur: color == groupItem.curKey }\"\n              @click=\"changeCurKey(index, groupIndex, color)\"\n            >\n              <div\n                class=\"color-bar-inner\"\n                :class=\"{ border: color == '#ffffff' }\"\n                :style=\"'background:' + color\"\n              ></div>\n            </div>\n            <el-color-picker\n              v-model=\"groupItem.editorKey\"\n              class=\"color-bar\"\n              size=\"mini\"\n              color-format=\"rgb\"\n              :class=\"{ cur: groupItem.editorKey == groupItem.curKey }\"\n              @active-change=\"(color) => changeCurKey(index, groupIndex, color)\"\n            ></el-color-picker>\n          </el-form-item>\n        </el-form>\n      </el-row>\n    </div>\n    <div slot=\"footer\" class=\"drawerEditor-foot\">\n      <el-button\n        :disabled=\"componentStyle == ''\"\n        type=\"info\"\n        @click=\"downloadCss\"\n        >下载css文件</el-button\n      >\n      <div>\n        <el-button\n          :disabled=\"componentStyle == ''\"\n          type=\"primary\"\n          icon=\"el-icon-refresh-left\"\n          @click=\"resetCss\"\n          >复原</el-button\n        >\n        <el-button type=\"primary\" @click=\"saveCSS\">保存</el-button>\n      </div>\n    </div>\n  </cube-drawer>\n</template>\n<script>\nimport componentConfig from './componentColor.json'\nimport '../../../../lib/styles/components/ThemeEditor.scss'\n\nexport default {\n  props: {\n    showEditor: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      visible: this.showEditor,\n      colorConfig: '',\n      componentStyle: ''\n    }\n  },\n  computed: {},\n  watch: {\n    showEditor(newVal, oldVal) {\n      this.visible = newVal\n      var localStorageConfig = JSON.parse(localStorage.getItem('colorStyle'))\n      if (localStorageConfig !== null) {\n        this.colorConfig = localStorageConfig.saveConfig\n        this.componentStyle = {\n          root: localStorageConfig.saveStyles\n        }\n        this.$emit('getComponentStyle', {\n          type: 'color',\n          saveStyles: this.componentStyle.root\n        })\n      } else {\n        this.colorConfig = this.resetConfig(componentConfig)\n      }\n    }\n  },\n  mounted() {\n    var localStorageConfig = JSON.parse(localStorage.getItem('colorStyle'))\n    if (localStorageConfig !== null) {\n      this.colorConfig = localStorageConfig.saveConfig\n    } else {\n      this.colorConfig = this.resetConfig(componentConfig)\n    }\n  },\n  methods: {\n    resetConfig(colorConfig) {\n      var config = JSON.parse(JSON.stringify(colorConfig))\n      config.forEach((item) => {\n        item.group.forEach((group) => {\n          group.editorKey = ''\n          group.oldKey = group.curKey\n        })\n      })\n      return config\n    },\n    closeDrawer() {\n      this.$emit('ifEditor', 'color', false)\n    },\n    changeCurKey(index, groupIndex, color) {\n      this.colorConfig[index].group[groupIndex].curKey = color\n      this.componentStyle = this.getcss(this.colorConfig)\n      this.$emit('getComponentStyle', {\n        type: 'color',\n        saveStyles: this.componentStyle.root\n      })\n    },\n    getcss(config) {\n      const result = {}\n      for (let i = 0; i < config.length; i++) {\n        const group = config[i].group\n        for (let j = 0; j < group.length; j++) {\n          const curKey = group[j].curKey\n          const cssVariables = group[j].cssVariable\n          for (let k = 0; k < cssVariables.length; k++) {\n            if (curKey !== group[j].oldKey) {\n              result[cssVariables[k]] = curKey\n            }\n          }\n        }\n      }\n      var root = ''\n      var ag = ''\n      for (const [key, value] of Object.entries(result)) {\n        if (key.startsWith('--ag')) {\n          ag += `${key}: ${value};`\n        } else {\n          root += `${key}: ${value};`\n        }\n      }\n      // 动态ag插入style\n      const el = document.getElementsByClassName('ag-theme-balham')\n      const agSpace =\n        localStorage.getItem('agSpaceStyle') != null\n          ? localStorage.getItem('agSpaceStyle')\n          : ''\n      const agStyle = ag + agSpace\n      for (let i = 0; i < el.length; i++) {\n        this.$nextTick(() => {\n          el[i].style = agStyle\n        })\n      }\n      return { root, ag }\n    },\n    saveCSS() {\n      if (this.componentStyle !== '') {\n        var saveConfig = this.colorConfig\n        var saveStyles = this.componentStyle.root\n        var obj = {\n          saveStyles,\n          saveConfig\n        }\n        localStorage.setItem('colorStyle', JSON.stringify(obj))\n        localStorage.setItem('agColorStyle', this.getcss(this.colorConfig).ag)\n        this.$emit('getComponentStyle', {\n          type: 'color',\n          saveStyles\n        })\n      }\n      this.$emit('ifEditor', 'color', false)\n    },\n    downloadCss() {\n      var css = this.getcss(this.colorConfig)\n      var cont = `\n     .body.theme-name{\n      // 此处theme-name为主题名\n        ${css.root}\n          .ag-theme-balham {\n            ${css.ag}\n          }\n      }`\n      var aTag = document.createElement('a')\n      var blob = new Blob([cont])\n      aTag.download = 'componentStyle.scss'\n      aTag.href = URL.createObjectURL(blob)\n      aTag.click()\n      URL.revokeObjectURL(blob)\n    },\n    resetCss() {\n      this.colorConfig = this.resetConfig(componentConfig)\n      this.componentStyle = ''\n      this.$emit('getComponentStyle', {\n        type: 'color',\n        saveStyle: this.componentStyle.root\n      })\n      window.localStorage.removeItem('componentStyle')\n    }\n  }\n}\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}